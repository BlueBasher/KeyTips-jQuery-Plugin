(function(n){jQuery.extend({trace:function(n,t){if(t===!1)return;typeof Debug!="undefined"&&Debug.writeln,window.console&&window.console.log&&window.console.log(n),window.opera&&window.opera.postError(n),window.debugService&&window.debugService.trace(n)},keyTips:function(t){n(function(){var y,o,r,u,e,i;y=!/opera/.test(navigator.userAgent);if(!y)return;o=n.browser.mozilla,r=!1,u=[],e=[],i=n.extend({debug:!1,highlightClass:"KeyTips__highlighted",popupClass:"KeyTips__popup",highlightMode:"popup",accessKeyTag:"em",offsets:{label:{left:-20,top:2},button:{left:-3,top:-3},anchor:{left:2,top:9},text:{left:-3,top:-3},other:{left:-3,top:-3}}},t);var h=function(n){var t=n.replace(/(:|\.)/g,"\\$1");return t==="#"&&(t=""),t},s=function(t){var i=h("#"+n(t).attr("htmlFor"));return n.trim(i!==""?n(i+"[accesskey]").attr("accesskey")||n(t).attr("accesskey"):n(t).attr("accesskey"))},k=function(t){var r=n(t);return r.is("label")?i.offsets.label:r.is(":button, :submit, :reset, :image")?i.offsets.button:r.is("a")?i.offsets.anchor:r.is(":text, textarea")?i.offsets.text:i.offsets.other},v=function(t){var u=n(t),i,r;return u.is(":hidden")||u.css("visibility")==="hidden"?!1:(i=u.offset(),r=k(t),i.left=i.left+r.left,i.top=i.top+r.top,i)},p=function(t,r){var o=v(t),f;if(o)return f=n("<div/>").text(r).css("left",o.left).css("top",o.top).addClass(i.popupClass).appendTo("body").get(0),u.push(f),e.push(t),f},c=function(){n(u).remove(),u=[],e=[]},b=function(){n("label[for], label[accesskey]").each(function(){var u=s(this),t,r;if(typeof u=="undefined"||u==="")return!0;t=n(this).html(),r=t.toUpperCase().indexOf(u.toUpperCase());if(r<0)return!0;var f="<"+i.accessKeyTag+">"+t.substr(r,1)+"</"+i.accessKeyTag+">",h=t.substring(0,r),o=t.substr(r+1),e=h+f+o;t.indexOf(f)<0&&n(this).html(e)})},l=function(){if(i.highlightMode=="popup"){c();var t=[];n("label > "+i.accessKeyTag).each(function(){var f=n(this).text(),i=n(this).parent(),u=h("#"+i.attr("htmlFor")),e=u!=="#"?n(u):null,r=s(i);r&&f.toUpperCase()==r.toUpperCase()&&p(i[0],r),t.push(e[0])}),n("a[href][accesskey], textarea[accesskey], input[accesskey]").each(function(){n.inArray(this,t)===-1&&p(this,this.accessKey)})}},d=function(){c(),l()},a=function(t){if(i.highlightMode==="popup"){var f=0;n.each(u,function(){var r=e[f],i;f++,i=v(r),n(this).css("left",i.left).css("top",i.top).toggle(t)})}else i.highlightMode==="toggleClass"&&n("label > "+i.accessKeyTag).each(function(){var f=n(this).text(),u=n(this).parent(),e=h("#"+u.attr("htmlFor")),r=s(u);r&&f.toUpperCase()!==r.toUpperCase()||n(this).toggleClass(i.highlightClass,t)});r=t},w=function(){a(!0)},f=function(){a(!1)};n(document).bind("keydown.keytips",function(t){n.trace("KeyTips document.keyDown: keyCode="+t.keyCode+", altKey="+t.altKey+", shiftKey="+t.shiftKey,i.debug),!r&&(t.keyCode==18&&!o||t.keyCode==16&&t.altKey&&o||t.keyCode==18&&t.shiftKey&&o)&&w()}).bind("keyup.keytips",function(t){n.trace("KeyTips document.keyUp: keyCode="+t.keyCode+", altKey="+t.altKey+", shiftKey="+t.shiftKey,i.debug),r&&f()}),n(window).bind("resize.keytips",function(){n.trace("resize event",i.debug),r&&i.highlightMode=="popup"&&f()}).bind("blur.keytips",function(){n.trace("blur event",i.debug),r&&f()}).bind("focus.keytips",function(){n.trace("focus event",i.debug),r&&f()}),b(),l()}),n(window).unload(function(){n(document).unbind(".keytips"),n(window).unbind(".keytips")})}})})(jQuery)